<!DOCTYPE html>
<html lang="en" x-data="app()">

<head>
    <meta charset="UTF-8">

    <title>Lanuit Admin</title>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script src="https://unpkg.com/alpinejs" defer></script>

    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="styles.css">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Favicons -->
    <link rel="icon" type="image/png" sizes="16x16" href="icons/favicon-16x16.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/favicon-32x32.png">

    <!-- iOS/Android home screen icon -->
    <link rel="apple-touch-icon" sizes="180x180" href="icons/apple-icon-180x180.png">
</head>

<body>
    <img id="animatedImage" src="icons/logo1x.png" alt="Logo">
    <div class="new-screen">


        <div x-show="page === 'login'" class="login-container">
            <div class="login-form">
                <img src="icons/logo1x.png" alt="Login" class="login-image">
                <input type="text" placeholder="Login" x-model="loginUsername">
                <div class="password-wrapper">
  <input :type="showLoginPassword ? 'text' : 'password'" placeholder="Password"
         x-model="loginPassword">
  <span class="toggle-password" @click="showLoginPassword = !showLoginPassword">
    <img x-show="showLoginPassword" src="icons/eye.fill.png" alt="Show Password" class="eye-icon">
    <img x-show="!showLoginPassword" src="icons/eye.slash.fill.png" alt="Hide Password" class="eye-icon">
  </span>
</div>
                <button @click="login()">Log in</button>
            </div>
            <p class="register-link">
                Donâ€™t have an account? <a @click="page = 'register'">Sign Up</a>
            </p>
        </div>


        <div x-show="page === 'register'" class="login-container">
            <div class="login-form">
                <img src="icons/logo1x.png" alt="Register" class="login-image">
                <input type="text" placeholder="Login" x-model="registerUsername">
                <div class="password-wrapper">
  <input :type="showRegisterPassword ? 'text' : 'password'" placeholder="Password"
         x-model="registerPassword">
  <span class="toggle-password" @click="showRegisterPassword = !showRegisterPassword">
    <img x-show="showRegisterPassword" src="icons/eye.fill.png" alt="Show Password" class="eye-icon">
    <img x-show="!showRegisterPassword" src="icons/eye.slash.fill.png" alt="Hide Password" class="eye-icon">
  </span>
</div>
                <div class="password-wrapper confirm">
  <input :type="showConfirmPassword ? 'text' : 'password'" placeholder="Confirm Password"
         x-model="confirmPassword">
  <span class="toggle-password" @click="showConfirmPassword = !showConfirmPassword">
    <img x-show="showConfirmPassword" src="icons/eye.fill.png" alt="Show Confirm Password" class="eye-icon">
    <img x-show="!showConfirmPassword" src="icons/eye.slash.fill.png" alt="Hide Confirm Password" class="eye-icon">
  </span>
</div>
                <button @click="register()">Register</button>
            </div>
            <p class="register-link">
                Already have an account? <a @click="page = 'login'">Log in</a>
            </p>
        </div>


        <div x-show="page === 'registerResponse'" class="login-container">
            <div class="login-form">
                <img src="icons/logo1x.png" alt="Register Response" class="login-image">

                <h2 class="register-success">Registration successful!</h2>
                <p class="register-success single-line">
                    A confirmation email will be sent to your inbox shortly.
                    <span x-text="registerUsername"></span>
                </p>
            </div>
            <p class="register-link">
                Back to <a @click="page = 'login'">Log in</a>
            </p>
        </div>


        <div x-show="page === 'main'" class="split-container">
            <aside class="split-sidebar">
                <nav class="tab-nav">
                    <button @click="activeTab = 'tab1'" :class="{ 'active': activeTab === 'tab1' }">
                        <img src="icons/dashboard.png" alt="Dashboard" class="icon">
                        Dashboard
                    </button>
                    <button @click="activeTab = 'tab2'" :class="{ 'active': activeTab === 'tab2' }">
                        <img src="icons/products.png" alt="Products" class="icon">
                        Products
                    </button>
                    <button @click="activeTab = 'tab3'" :class="{ 'active': activeTab === 'tab3' }">
                        <img src="icons/orders.png" alt="Orders" class="icon">
                        Orders
                    </button>
                    <button @click="activeTab = 'tab4'" :class="{ 'active': activeTab === 'tab4' }">
                        <img src="icons/settings.png" alt="Settings" class="icon">
                        Settings
                    </button>
                    <button @click="activeTab = 'tab5'" :class="{ 'active': activeTab === 'tab5' }">
                        <img src="icons/notifications.png" alt="Notifications" class="icon">
                        Notifications
                    </button>
                </nav>
            </aside>

            <main class="split-content">
                <div x-show="activeTab === 'tab1'" x-init="saleStatisticsGraph()"
                    x-effect="if (activeTab === 'tab1') saleStatisticsGraph()" class="tab-content">
                    <h1 class="page-title">Dashboard</h1>
                    <canvas x-ref="salesChart"></canvas>
                </div>

                <div x-show="activeTab === 'tab2'" x-effect="if (activeTab === 'tab2') fetchCategories()"
                    class="tab-content">

                    <div class="page-header">
                        <div class="page-header-spacer"></div>
                        <h1 class="page-title">Products</h1>
                        <button class="header-button" @click="showAddCategory = true">
                            <img src="icons/plus.png" alt="plus" class="icon" />
                            Add Category
                        </button>
                    </div>
                    <p x-show="products.length === 0" class="empty-message">There is no product yet</p>

                    <div x-show="products.length > 0" class="product-list" x-transition>
                        <template x-for="category in products" :key="category.id">

                            <div class="product-row" x-data="{ 
                showForm: false, 
                tempName: '', 
                tempPrice: null, 
                tempOrderNumber: null
            }">
                                <p class="product-name" x-text="category.name"></p>
                                <div class="product-line"></div>

                                <button class="header-button" @click="showForm = true">
                                    <img src="icons/plus.item.png" alt="Add Product" class="product-image-button">
                                </button>

                                <div x-show="showForm" class="new-product-form" x-transition>
                                    <h2>New Product for <span x-text="category.name"></span></h2>

                                    <input type="text" placeholder="Product Name" x-model="tempName">
                                    <input type="number" placeholder="Price" x-model="tempPrice">
                                    <input type="number" placeholder="Order Number" x-model="tempOrderNumber">

                                    <input type="text" placeholder="Category ID" :value="category.id" readonly>

                                    <input type="file" id="productImage-{{ category.id }}"
                                        @change="$root.handleImageUpload($event, category.id)">

                                    <div class="form-buttons">
                                        <button @click="$root.addNewProduct({
                                    name: tempName, 
                                    price: tempPrice, 
                                    order_number: tempOrderNumber 
                                }, category.id); 
                                showForm = false">Save</button>
                                        <button @click="showForm = false">Cancel</button>
                                    </div>
                                </div>
                            </div>
                        </template>
                    </div>
                </div>




                <div x-show="activeTab === 'tab3'" class="tab-content">
                    <h1 class="page-title">Orders</h1>
                    <p>Orders content goes here</p>
                </div>

                <div x-show="activeTab === 'tab4'" class="tab-content">
                    <h1 class="page-title">Settings</h1>
                    <p>Settings content goes here</p>
                </div>

                <div x-show="activeTab === 'tab5'" class="tab-content">
                    <h1 class="page-title">Notifications</h1>
                    <p>Notifications content goes here</p>
                </div>
            </main>
        </div>

        <div x-show="showAddCategory" class="alert-backdrop" x-transition>
            <div class="alert-box">
                <h2 class="alert-title">Name</h2>
                <input type="text" placeholder="Enter product name" class="alert-input" x-model="newCategory">
                <div class="alert-line"></div>
                <button class="alert-button cancel" @click="showAddCategory = false">Cancel</button>
                <button class="alert-button create" @click="createCategory()">
                    Create
                </button>
            </div>
        </div>

        <script src="app.js"></script>
</body>

</html>